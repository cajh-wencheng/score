<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ®µè€ƒæˆç¸¾æŸ¥è©¢</title>
    <style>
        body {
            font-family: "DFKai-SB", Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        h1 {
            font-size: 3.0em;
            color: #007BFF;
            text-align: center;
            margin-bottom: 20px;
        }

        label {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            font-size: 1.3em;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
            color: #555;
        }

        select, input[type="password"] {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            font-size: 1.2em;
            font-weight: bold;
            padding: 10px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 300px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        button {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            font-size: 1.3em;
            font-weight: bold;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #5a5a5a;
        }

        #result {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            font-size: 1.3em;
        }

        #result p {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            font-weight: bold;
            margin: 10px 0;
            color: #008000;
        }

        #result p span.number {
            font-family: "Times New Roman", serif;
            color: #000;
        }
    </style>

    <script>
        console.log("ğŸš€ JavaScript å·²ç¶“é–‹å§‹åŸ·è¡Œï¼");  // â† æ¸¬è©¦æ˜¯å¦æœ‰åŸ·è¡Œ
        const SHEET_ID = '1i3x67udPJRqjJZ6NLeRVXhjIJ0Vcv54CXWNQTezL6S0';  // âš ï¸ é€™è£¡å¡«å…¥ä½ çš„ Google è©¦ç®—è¡¨ ID
        const API_KEY = 'AIzaSyAI1Fr3Q_NthL7adXW9DUqO24pu7vQrpDc';  // âš ï¸ é€™è£¡å¡«å…¥ä½ çš„ Google API é‡‘é‘°
        const SHEET_NAME = 'å·¥ä½œè¡¨1';  // ä¾‹å¦‚ 'Sheet1'

        // å–å¾—è©¦ç®—è¡¨è³‡æ–™
        async function fetchSheetData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
            const response = await fetch(url);
            const data = await response.json();
            return data.values;
        }

        // åˆå§‹åŒ–ä¸‹æ‹‰é¸å–®
        async function loadDropdownOptions() {
            const data = await fetchSheetData();
            const seatNumbers = [...new Set(data.slice(1).map(row => row[0]))];
            const counts = [...new Set(data.slice(1).map(row => row[1]))];

            const seatNumberSelect = document.getElementById('seatNumber');
            const countSelect = document.getElementById('count');

            seatNumberSelect.innerHTML = '';
            countSelect.innerHTML = '';

            seatNumbers.forEach(seat => {
                const option = document.createElement('option');
                option.value = seat;
                option.textContent = seat;
                seatNumberSelect.appendChild(option);
            });

            counts.forEach(count => {
                const option = document.createElement('option');
                option.value = count;
                option.textContent = count;
                countSelect.appendChild(option);
            });
        }

        // æŸ¥è©¢æˆç¸¾
        async function filterData() {
            const seatNumber = document.getElementById('seatNumber').value;
            const count = document.getElementById('count').value;
            const password = document.getElementById('password').value;

            const data = await fetchSheetData();
            const filteredData = data.slice(1).find(row => row[0] === seatNumber && row[1] === count && row[2] === password);

            const resultDiv = document.getElementById('result');
            if (filteredData) {
                resultDiv.innerHTML = `
                    <p><span>åº§è™Ÿ:</span> <span class="number">${filteredData[3]}</span></p>
                    <p><span>å§“å:</span> <span class="chinese">${filteredData[4]}</span></p>
                    <p><span>åœ‹æ–‡:</span> <span class="number">${filteredData[5]}</span></p>
                    <p><span>è‹±æ–‡:</span> <span class="number">${filteredData[6]}</span></p>
                    <p><span>æ•¸å­¸:</span> <span class="number">${filteredData[7]}</span></p>
                    <p><span>è‡ªç„¶:</span> <span class="number">${filteredData[8]}</span></p>
                    <p><span>ç¤¾æœƒ:</span> <span class="number">${filteredData[9]}</span></p>
                    <p><span>ç¸½åˆ†:</span> <span class="number">${filteredData[10]}</span></p>
                    <p><span>å¹³å‡:</span> <span class="number">${filteredData[11]}</span></p>
                    <p><span>æ’å:</span> <span class="number">${filteredData[12]}</span></p>
                    <p><span>ä¸Šæ¬¡æ’å:</span> <span class="number">${filteredData[13]}</span></p>
                    <p><span>é€²æ­¥åˆ†æ•¸:</span> <span class="number">${filteredData[14]}</span></p>
                    <img src="${filteredData[15]}" alt="æˆç¸¾åœ–ç‰‡" style="max-width: 100%;">
                `;
            } else {
                resultDiv.innerHTML = '<p style="color:red;">æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ã€‚</p>';
            }
        }

        window.onload = loadDropdownOptions;
    </script>
</head>

<body>
    <h1>æ®µè€ƒæˆç¸¾æŸ¥è©¢ç³»çµ±</h1>
    <label for="seatNumber">åº§è™ŸåŠå§“å:</label>
    <select id="seatNumber"></select>
    <br>
    <label for="count">æ¬¡æ•¸:</label>
    <select id="count"></select>
    <br>
    <label for="password">å¯†ç¢¼:</label>
    <input type="password" id="password">
    <br>
    <button onclick="filterData()">æŸ¥è©¢</button>
    <div id="result"></div>
</body>

</html>
